{%- comment -%}
  Unified category link w/ count using category_registry.yml
  Usage: {% include utility/full-category.html category=raw_name_or_slug render-number=true category=pair[0] category_obj=pair[1] %}
{%- endcomment -%}
{% assign registry = site.data.category_registry %}
{% assign raw = include.category | to_s %}
{% assign canonical = nil %}
{% if registry[raw] %}
  {% assign canonical = raw %}
{% else %}
  {% assign lower = raw | downcase %}
  {% for pair in registry %}
    {% assign slug = pair[0] %}
    {% assign data = pair[1] %}
    {% if canonical %}{% break %}{% endif %}
    {% if data.raw_names %}
      {% for variant in data.raw_names %}
        {% if variant and variant downcase == lower %}
          {% assign canonical = slug %}
          {% break %}
        {% endif %}
      {% endfor %}
    {% endif %}
  {% endfor %}
{% endif %}
{% if canonical == nil %}{% assign canonical = raw | slugify %}{% endif %}
{% assign entry = registry[canonical] %}
{% assign display = entry.label | default: entry.title | default: raw %}
{% assign klass = entry.class | default: canonical %}
<a style="text-decoration: none; font-size: x-large;" class="{{klass}}" href="{{site.url}}/category/{{canonical}}">{% include utility/category-emoji.html category=display %} {{ display }}{% if include.render-number == true and include.category_obj %} ({{ include.category_obj.size }}){%endif %}</a>