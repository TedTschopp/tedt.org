  {% include assets/js-fontawesome.html %}

  {% if page.mathjax %}
    <!-- mathjax -->
    <script type="text/javascript" async
         src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js">
      </script>
    {% endif %}

    {% if mf-location == true %}
    <!-- Leaflet Open Street Maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
      integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
      crossorigin=""/>
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
      integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
      crossorigin=""></script>
    <style>
      #mapid { height: 400px; }
    </style>
    {% endif %}

    <!-- Webmentions code -->
    <script src="/js/webmention.js/static/webmention.js"  data-comments-are-reactions="true" async></script>

    <!-- Start of Rough Notation Code --->
    {% include assets/rough-notation.html %}

    <!-- Winerlinks code-->
    <script src="/js/winerlinks.js" async></script>

    <!-- blurhash - load conditionally to avoid module errors -->
    <script>
        // Only load blurhash if we're in a proper browser context
        try {
            // Check if we're in a browser context and blurhash isn't already loaded
            if (typeof window !== 'undefined' && typeof window.BlurHash === 'undefined') {
                // Temporarily define module as undefined to prevent module detection errors
                const originalModule = window.module;
                window.module = undefined;
                
                // Load the script dynamically
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/blurhash@2.0.5/dist/index.min.js';
                script.async = true;
                script.onload = function() {
                    // Restore original module value after loading
                    if (originalModule !== undefined) {
                        window.module = originalModule;
                    } else {
                        delete window.module;
                    }
                };
                script.onerror = function() {
                    console.warn('BlurHash library failed to load - image lazy loading may not work optimally');
                    // Restore original module value on error too
                    if (originalModule !== undefined) {
                        window.module = originalModule;
                    } else {
                        delete window.module;
                    }
                };
                document.head.appendChild(script);
            }
        } catch (e) {
            console.warn('BlurHash loading skipped due to compatibility issues:', e);
        }
    </script>

    <!-- Start Clarity Code -->
    {% include analytics/clarity.html %}

    <!-- Start Google Analytics-->
    {% include analytics/google-analytics.html %}



{% comment %}    
    <!-- Start of Async Drift Code --->
    <!-- include js-drift.html --->


    <!-- Start MailChip Code -->
    <!-- include js-mailchimp.html --->

{% endcomment %}    
