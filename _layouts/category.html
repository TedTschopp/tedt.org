<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="utf-8">
  <title>{{ page.title | escape }} â€“ {{ site.title }}</title>

    {% include utility/calculate-variables.html %}

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <!-- IndieAuth and WebMentions Metadata -->
    {% include seo/indieauth-webmentions-metadata.html %}

    <!-- SEO Metadata -->
    {% include seo/meta-data-seo.html %}

    <!-- PWA Header Includes -->
    {% include pwa/pwa-header-includes.html %}

    <!-- News Feed Meta Tags. -->
    {% include feeds/feeds.html %}

    <!-- START OF CSS INCLUDE -->

  {% include assets/all-css-includes.html %}


    <!-- END OF CSS INCLUDE -->

    <!-- Scripts that need to be at the end of the header -->
    {% include assets/scripts.html %}


  </head>

  <body style="scroll-padding-top: 70px;" data-bs-spy="scroll" data-bs-target="#navbarNavDarkDropdown" data-bs-offset="70">
  {%- comment -%} Removed skip link per user request. {%- endcomment -%}
    {% include layout/top-nav-bar.html %}

    <!-- Page Content -->
    <div class="container">
        <div class="row">
            <!-- Blog Post Content Column -->
            <div class="col-lg-8">
                <!-- Blog Post -->
                <main class="h-entry" role="main">
                    <!-- Title -->
                    {% capture __cat_slug %}{% include utility/map-category-to-registry.html key=page.title %}{% endcapture %}
                    {% assign __cat_slug = __cat_slug | strip %}
                    {% if __cat_slug == '' %}{% assign __cat_slug = page.title | slugify %}{% endif %}
                    {%- comment -%} Fallback: if mapping failed and registry lacks this slug but a registry title matches page.title, adopt that slug {%- endcomment -%}
                    {% if site.data.category_registry[__cat_slug] == nil %}
                      {% assign __title_norm = page.title | downcase %}
                      {% for pair in site.data.category_registry %}
                        {% assign _slug = pair[0] %}
                        {% assign _entry = pair[1] %}
                        {% if _entry.title %}
                          {% assign _entry_title_down = _entry.title | downcase %}
                          {% if _entry_title_down == __title_norm %}
                            {% assign __cat_slug = _slug %}
                            {% break %}
                          {% endif %}
                        {% endif %}
                      {% endfor %}
                    {% endif %}
                    {% assign __cat_entry = site.data.category_registry[__cat_slug] %}
                    {% if __cat_entry and __cat_entry.category_home_page %}
                      {% assign __cat_href = __cat_entry.category_home_page %}
                    {% else %}
                      {% assign __cat_href = '/category/' | append: __cat_slug | append: '/' %}
                    {% endif %}
                    {% if __cat_entry %}
                      {% capture _title_html %}{% include utility/category-label.html category=__cat_slug href=__cat_href kind='title' class_extra='text-decoration-none' wrapper_class_extra='category-page-head' legacy_class=false %}{% endcapture %}
                      {% include utility/category-palette-apply.html entry=__cat_entry slug=__cat_slug raw=page.title title_html=_title_html title_tag='div' title_class='p-name category-title-wrapper' wrapper_class='category-hero category-hero-page' %}
                    {% else %}
                      <h1 class="p-name">
                        {% include utility/category-label.html category=__cat_slug href=__cat_href kind='title' class_extra='text-decoration-none' wrapper_class_extra='category-page-head' legacy_class=false %}
                      </h1>
                    {% endif %}
                    {%- comment -%} Subtitle: prefer registry entry subtitle, fallback to page.subtitle {%- endcomment -%}
                    {% assign _subtitle = '' %}
                    {% if __cat_entry and __cat_entry.subtitle %}
                      {% assign _subtitle = __cat_entry.subtitle %}
                    {% elsif page.subtitle %}
                      {% assign _subtitle = page.subtitle %}
                    {% endif %}
                    {% if _subtitle != '' %}
                      <h2 class="category-subtitle">{{ _subtitle }}</h2>
                    {% endif %}
                    {%- comment -%}
                      Category pages should use the same selector rules as the homepage category carousel:
                      match posts by canonical slug, registry title, and any registry raw_names aliases.

                      IMPORTANT: do not derive registry lookup from `page.category | slugify`.
                      Many categories have canonical slugs that differ from the slugified title (e.g. AI).
                    {%- endcomment -%}
                    {% assign category = __cat_slug %}
                    {% assign registry_entry = __cat_entry %}
                    {%- capture __category_wrapper_style -%}{% include utility/category-theme-inline-style.html entry=registry_entry %}{%- endcapture -%}
                    {% assign __category_wrapper_style = __category_wrapper_style | strip %}
                    {% if registry_entry and registry_entry.image %}
                      {% assign image_path = registry_entry.image %}
                    {% else %}
                      {% assign image_path = '/img/categories/' | append: category | append: '.webp' %}
                    {% endif %}
            <figure class="category-theme" data-category="{{ registry_entry.title | default: page.category }}" data-cat="{{ category }}"{% if __category_wrapper_style != '' %} style="{{ __category_wrapper_style }}"{% endif %}>
            <img class="img-responsive img-thumbnail" src="{{ site.url }}{{ image_path }}" alt="{{ registry_entry.title | default: page.category }}">
          </figure>
                    <!-- Determine description: prefer registry entry, fall back to page.description, then excerpt, then stripped content -->
                    {% if registry_entry and registry_entry.description %}
                      {% assign SEO-description = registry_entry.description %}
                    {% elsif page.description and page.description != '' %}
                      {% assign SEO-description = page.description %}
                    {% elsif page.excerpt != '' %}
                      {% assign SEO-description = page.excerpt | strip_html %}
                    {% else %}
                      {% assign SEO-description = stripped-content %}
                    {% endif %}
                    {% if SEO-description %}
                      <p class="category-description">{{ SEO-description }}</p>
                    {% endif %}

                    <span class="e-content" id="main_content">
                      {%- comment -%}
                        Build a unified post list across all category variants (page.category, canonical slug,
                        registry title, and raw_names), then sort newest-first and de-dupe by URL.
                      {%- endcomment -%}
                      {% assign __variant_keys = '' | split: '' %}
                      {% if page.category and page.category != '' %}
                        {% assign __variant_keys = __variant_keys | push: page.category %}
                      {% endif %}
                      {% if category and category != '' %}
                        {% assign __variant_keys = __variant_keys | push: category %}
                      {% endif %}
                      {% if registry_entry and registry_entry.title and registry_entry.title != '' %}
                        {% assign __variant_keys = __variant_keys | push: registry_entry.title %}
                      {% endif %}
                      {% if registry_entry and registry_entry.raw_names %}
                        {% if registry_entry.raw_names.first %}
                          {% for rn in registry_entry.raw_names %}
                            {% if rn and rn != '' %}
                              {% assign __variant_keys = __variant_keys | push: rn %}
                            {% endif %}
                          {% endfor %}
                        {% else %}
                          {% assign __variant_keys = __variant_keys | push: registry_entry.raw_names %}
                        {% endif %}
                      {% endif %}

                      {% assign __posts_union = '' | split: '' %}
                      {% for k in __variant_keys %}
                        {% assign _arr = site.categories[k] %}
                        {% if _arr and _arr != empty %}
                          {% for p in _arr %}
                            {% assign __posts_union = __posts_union | push: p %}
                          {% endfor %}
                        {% endif %}
                      {% endfor %}

                      {% assign __posts_union = __posts_union | safe_sort: 'date' | reverse %}
                      {% assign posts_arr = '' | split: '' %}
                      {% assign __seen_urls = '' | split: '' %}
                      {% for p in __posts_union %}
                        {% if __seen_urls contains p.url %}{% continue %}{% endif %}
                        {% assign __seen_urls = __seen_urls | push: p.url %}
                        {% assign posts_arr = posts_arr | push: p %}
                      {% endfor %}

                      {%- comment -%}
                        Fallback: if we somehow didn't resolve via site.categories (rare), scan posts
                        using the same matching rules as the homepage carousel.
                      {%- endcomment -%}
                      {% if (posts_arr == nil or posts_arr == empty) and registry_entry %}
                        {% assign __scan = site.posts | safe_sort: 'date' | reverse %}
                        {% for p in __scan %}
                          {% assign post_match = false %}
                          {% if p.categories %}
                            {% if registry_entry.title and p.categories contains registry_entry.title %}
                              {% assign post_match = true %}
                            {% endif %}
                            {% if post_match == false and category and p.categories contains category %}
                              {% assign post_match = true %}
                            {% endif %}
                            {% if post_match == false and registry_entry.raw_names %}
                              {% if registry_entry.raw_names.first %}
                                {% for rn in registry_entry.raw_names %}
                                  {% if p.categories contains rn %}{% assign post_match = true %}{% break %}{% endif %}
                                {% endfor %}
                              {% else %}
                                {% if p.categories contains registry_entry.raw_names %}{% assign post_match = true %}{% endif %}
                              {% endif %}
                            {% endif %}
                          {% endif %}
                          {% unless post_match %}{% continue %}{% endunless %}
                          {% if __seen_urls contains p.url %}{% continue %}{% endif %}
                          {% assign __seen_urls = __seen_urls | push: p.url %}
                          {% assign posts_arr = posts_arr | push: p %}
                        {% endfor %}
                      {% endif %}
                      <ol class="list-unstyled" aria-label="Posts in category {{ page.category }}">
                        {% for post in posts_arr %}
                        <li class="list-item-custom">
                              <div class="container">
                                <div class="row align-items-stretch">
                                 
                                  {% if post.image and post.image != '' %}
                                    {% if post.image-alt %}
                                        {% assign image_alt = post.image-alt %}
                                    {% elsif post.image-description %}
                                        {% assign image_alt = post.image-description %}
                                    {% else %}
                                        {% assign image_alt = post.title %}
                                    {% endif %}
            
                                    {% if post.image-credits-title %}
                                        {% assign image_credits_title = post.image-credits-title %}
                                    {% elsif post.image-title %}
                                        {% assign image_credits_title = post.image-title %}
                                    {% else %}
                                        {% assign image_credits_title = "Unknown" %}
                                    {% endif %}
            
                                    {% if post.image-credits-artist %}
                                        {% assign image_credits = post.image-credits-artist %}
                                    {% elsif post.image-artist %}
                                        {% assign image_credits = post.image-artist %}
                                    {% else %}
                                        {% assign image_credits = "Unknown" %}
                                    {% endif %}
            
                                    {% if post.image-credits-artist-URL %}
                                      {% assign image_credits_artist_URL = post.image-credits-artist-URL %}
                                    {% elsif post.image-artist-URL %}
                                        {% assign image_credits_artist_URL = post.image-artist-URL %}
                                    {% endif %}
            
                                    {% if post.image %}
                                      {% assign _image_raw = post.image | strip %}
                                      {% assign _image_first = _image_raw | slice: 0, 1 %}
                                      {% assign _image_first2 = _image_raw | slice: 0, 2 %}
                                      {% if _image_raw contains '://' or _image_first2 == '//' %}
                                        {% assign image_URL = _image_raw %}
                                      {% elsif _image_first == "/" %}
                                        {% assign image_URL = site.url | append: _image_raw %}
                                      {% else %}
                                        {% assign image_URL = site.url | append: "/" | append: _image_raw %}
                                      {% endif %}
                                    {% else %}
                                      {% assign image_URL = site.featured-image %}
                                    {% endif %}

                                    <div class="card rounded-0 px-0">
                                      <div class="row g-0">
                                        <div class="col-md-4">
                                          <img src="{{ image_URL }}" alt="{{ image_alt }} by {{ image_credits }}" class="img-fluid rounded-start"
                                            style="width: 100%; height: 100%; object-fit: cover;" loading="lazy">
                                        </div>
                                        <div class="col-md-8">
                                          <div class="card-body">
                                            <h4 class="card-title three-line-clamp">
                                              <a href="{{ post.url | absolute_url }}">{{ post.title }}</a>
                                            </h4>
                                            <p class="card-text 3">
                                              {{ post.teaser | default: post.description | default: post.excerpt | strip_html }}
                                            </p>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  {% else %}
                                    <div class="card rounded-0 px-0">
                                      <div class="row g-0">
                                        <div class="col-md-12">
                                          <div class="card-body">
                                            <h4 class="card-title three-line-clamp">
                                              <a href="{{ post.url | absolute_url }}">{{ post.title }}</a>
                                            </h4>
                                            <p class="card-text truncate-3">
                                              {{ post.teaser | default: post.description | default: post.excerpt | strip_html }}
                                            </p>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  {% endif %}
                                </div>
                              </div>
                            </li>
                        {% endfor %}
                      </ol>                    
                      </span>

                </main>

                <hr>
                {% if page.mastodon-post-id and page.mastodon-post-id != '' %}
                  {% include social/comments-mastodon-tree.html %}
                {% endif %}

                {% include social/comments-webmentions.html %}

            </div>

            <!-- Blog Sidebar Widgets Column -->
            <div class="col-md-4">


                <!-- Blog Categories Well -->
                <div class="well">
                    <div class="post-categories">
                        <h4>All Categories</h4>
                        {%- comment -%}
                          Build a sortable array of categories (slug||label) so we can alphabetize by
                          the rendered label/title instead of YAML file order.
                        {%- endcomment -%}
                        {% assign cat_items = '' | split: '' %}
                        {% for pair in site.data.category_registry %}
                          {% assign slug = pair[0] %}
                          {% assign reg_entry = pair[1] %}
                          {% if reg_entry.hide_from_category_list %}{% continue %}{% endif %}
                          {% assign label = reg_entry.label | default: reg_entry.title | default: slug %}
                          {% assign cat_entry = slug | append: '||' | append: label %}
                          {% assign cat_items = cat_items | push: cat_entry %}
                        {% endfor %}
                        {% assign cat_items = cat_items | safe_sort | sort_natural %}
                        <ul class="list-unstyled" aria-label="All site categories">{% for item in cat_items %}{% assign parts = item | split: '||' %}{% assign slug = parts[0] %}{% assign label = parts[1] %}{% assign reg_entry = site.data.category_registry[slug] %}{% assign posts_arr = site.categories[label] | default: site.categories[reg_entry.title] | default: site.categories[slug] %}{% if posts_arr == nil or posts_arr == empty %}{% if reg_entry.raw_names %}{% for variant in reg_entry.raw_names %}{% if site.categories[variant] and site.categories[variant] != empty %}{% assign posts_arr = site.categories[variant] %}{% break %}{% endif %}{% endfor %}{% endif %}{% endif %}{% assign count = posts_arr.size | default: 0 %}{% capture badge_text %}{{ label }} - {{ count }}{% endcapture %}{% if reg_entry.category_home_page %}{% assign _href = reg_entry.category_home_page %}{% else %}{% assign _href = '/category/' | append: slug | append: '/' %}{% endif %}<li class="mb-1">{% include utility/category-label.html category=slug href=_href kind='badge' legacy_class=false class_extra='text-decoration-none w-100' wrapper_class_extra='no-underline full-width-badge' text_override=badge_text %}</li>{% endfor %}</ul>

                      </div>
                </div>

              </div>
        </div>
        <!-- /.row -->

        <hr>
    </div>
    <!-- /.container -->

    <!-- Footer -->
    {% include layout/footer.html %}

    {% include assets/js-bottom-of-body.html %}

  </body>
</html>







