<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt Library – Curated AI Prompts Collection</title>

    {% include utility/calculate-variables.html %}

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">

    <!-- IndieAuth and WebMentions Metadata -->
    {% include seo/indieauth-webmentions-metadata.html %}

    <!-- SEO Metadata -->
    {% include seo/meta-data-seo.html %}

    <!-- PWA Header Includes -->
    {% include pwa/pwa-header-includes.html %}

    <!-- News Feed Meta Tags -->
    {% include feeds/feeds.html %}

    <!-- START OF CSS INCLUDE -->
    {% include assets/all-css-includes.html %}
    <!-- END OF CSS INCLUDE -->

    <!-- Scripts that need to be at the end of the header -->
    {% include assets/scripts.html %}

    <style>
        .btn-toggle[aria-pressed="true"] {
            background-color: #0d6efd;
            color: #fff;
        }
    
        .visually-hidden {
            position: absolute !important;
            width: 1px !important;
            height: 1px !important;
            padding: 0 !important;
            margin: -1px !important;
            overflow: hidden !important;
            clip: rect(0, 0, 0, 0) !important;
            border: 0 !important;
        }
    
        .btn-copy-prompt {
            background-color: #20c997;
            border: none;
            color: rgba(16, 24, 32, 1.00);
        }
    
        .btn-copy-prompt:hover,
        .btn-copy-prompt:focus {
            background-color: #29EDA5;
            /* was #17a589;*/
            color: rgba(0, 0, 0, 1.00)
        }

        .tag-filter-btn {
            transition: all 0.2s ease;
        }

        .tag-filter-btn:hover {
            background-color: #0056b3 !important;
            transform: scale(1.05);
        }

        .tag-filter-btn:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>

<body style="scroll-padding-top: 70px;" data-bs-spy="scroll" data-bs-target="#navbarNavDarkDropdown"
    data-bs-offset="70">

    <!-- Navbar -->
    {% include layout/top-nav-bar.html %}


    <header>
        <section class="showcase position-relative">
            <div class="g-0 w-100 container-fluid">
                <div class="w-100 position-relative">
                    <img src="../img/categories/prompt_library.webp" class="img-fluid w-100 h-100"
                        alt="Library of Lost Prompts" loading="lazy">
                </div>
            </div>
        </section>
    </header>

    <main class="container my-4" id="main-content" role="main">
        <h2 class="visually-hidden">AI Prompt Library Search and Browse</h2>
        <!-- Search Bar and Sort Dropdown -->
        <section aria-label="Filter and Sort Controls" class="mb-3">
            <div class="d-flex flex-column flex-md-row gap-2 w-100">
                <form role="search" aria-label="Search prompts" class="flex-grow-1">
                    <div class="input-group">
                        <span class="input-group-text" id="search-label"><i class="fas fa-search" aria-hidden="true"></i></span>
                        <input type="text" class="form-control" placeholder="Search prompts..." aria-label="Search prompts" aria-describedby="search-label">
                    </div>
                </form>
                <div class="flex-shrink-0" style="min-width:200px;">
                    <label for="sort-select" class="visually-hidden">Sort prompts</label>
                    <select class="form-select" id="sort-select" aria-label="Sort prompts">
                        <option value="newest">Sort by Newest</option>
                        <option value="highest">Sort by Highest Rating</option>
                        <option value="alphabetical">Sort Alphabetically</option>
                    </select>
                </div>
            </div>
            <div class="d-flex flex-wrap gap-2 mt-3" role="group" aria-label="Filter prompts by category">
                <button class="btn btn-outline-secondary btn-toggle flex-fill" style="min-width: 140px;" 
                        aria-pressed="true" data-filter="all">All Categories</button>
                
                {% assign prompt_posts = site.posts | where: "categories", "Prompts" %}
                {% assign all_tags = "" | split: "," %}
                {% for post in prompt_posts %}
                    {% for tag in post.tags %}
                        {% unless all_tags contains tag %}
                            {% assign all_tags = all_tags | push: tag %}
                        {% endunless %}
                    {% endfor %}
                {% endfor %}
                
                {% assign sorted_tags = all_tags | sort %}
                {% for tag in sorted_tags limit: 20 %}
                    <button class="btn btn-outline-secondary btn-toggle flex-fill" 
                            style="min-width: 140px;" 
                            aria-pressed="false" 
                            data-filter="{{ tag | slugify }}">{{ tag }}</button>
                {% endfor %}
                
                <button class="btn btn-outline-secondary flex-fill" 
                        style="min-width: 140px;" 
                        aria-label="Clear all filters"
                        id="clear-filters">Clear Filters</button>
            </div>
        </section>

        <!-- Loading Spinner Placeholder -->
        <div id="loading-spinner" class="text-center my-5" style="display:none;">
            <div class="spinner-border text-primary" role="status" aria-label="Loading prompts..."></div>
        </div>

        <!-- Prompt List -->
        <section aria-label="Prompt List">
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                <!-- Dynamic Jekyll Prompt Cards -->
                {% assign prompt_posts = site.posts | where: "categories", "Prompts" %}
                {% for post in prompt_posts %}
                <div class="col" data-tags="{{ post.tags | join: ',' | slugify }}" 
                     data-date="{{ post.date | date: '%Y%m%d' }}" 
                     data-title="{{ post.title | slugify }}"
                     data-likes="0">
                    <div class="card h-100 d-flex flex-column" tabindex="0" aria-label="Prompt: {{ post.title }}">
                        <div class="card-body d-flex flex-column">
                            <a href="{{ post.url | relative_url }}" class="text-decoration-none text-reset">
                                <h5 class="card-title">{{ post.title }}</h5>
                            </a>
                            <p class="card-text">
                                {% if post.description %}
                                    {{ post.description | strip_html | truncate: 150 }}
                                {% else %}
                                    {{ post.excerpt | strip_html | truncate: 150 }}
                                {% endif %}
                            </p>
                            <div class="mt-auto">
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <div>
                                        {% if post.tags %}
                                            {% for tag in post.tags limit: 2 %}
                                                <button class="badge bg-primary tag-filter-btn" 
                                                        title="Filter by {{ tag }}"
                                                        data-tag="{{ tag | slugify }}"
                                                        style="cursor: pointer; border: none;">
                                                    <i class="fas fa-tag" aria-hidden="true"></i> {{ tag }}
                                                </button>
                                            {% endfor %}
                                        {% endif %}
                                    </div>
                                    <div class="like-container">
                                        <button class="btn btn-outline-danger btn-sm btn-like" aria-label="Like this prompt">
                                            <i class="fas fa-heart"></i> 
                                            <span class="like-count">0</span>
                                        </button>
                                    </div>
                                </div>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-copy-prompt btn-sm w-100 animate__animated" 
                                            aria-label="Copy prompt to clipboard"
                                            data-prompt-url="{{ post.url | relative_url }}"
                                            data-prompt-title="{{ post.title }}">
                                        <i class="fas fa-copy"></i> Copy Prompt
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            <!-- Message for empty results -->
            <div id="no-results-message" class="alert alert-warning mt-4 text-center" style="display:none;" role="status">
                No prompts found. Try adjusting your search or filters.
            </div>
        </section>

        <!-- Pagination -->
        <nav class="mt-4" aria-label="Prompt pagination">
            <ul class="pagination justify-content-center">
                <li class="page-item disabled">
                    <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
                </li>
                <li class="page-item active" aria-current="page">
                    <a class="page-link" href="#">1</a>
                </li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item">
                    <a class="page-link" href="#">Next</a>
                </li>
            </ul>
        </nav>
    </main>

    <!-- Footer -->
    {% include layout/footer.html %}
    
    <!-- Bootstrap core JavaScript -->
    {% include assets/js-bottom-of-body.html %}


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Pagination and filtering state
        let currentPage = 1;
        let itemsPerPage = 12;
        let filteredCards = [];
        let allCards = [];
        let currentFilter = 'all';
        let currentSearchTerm = '';
        let currentSort = 'newest';

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            allCards = Array.from(document.querySelectorAll('.col[data-tags]'));
            filteredCards = [...allCards];
            updatePagination();
            showPage(1);
            
            // Add hover tooltips to tag buttons
            document.querySelectorAll('.tag-filter-btn').forEach(btn => {
                const tagName = btn.textContent.trim().replace('🏷️ ', '').replace(' ', '');
                btn.setAttribute('title', `Click to filter by ${tagName}`);
            });
        });

        // Toggle filter button active state and filter prompts
        document.querySelectorAll('.btn-toggle').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.btn-toggle').forEach(b => b.setAttribute('aria-pressed', 'false'));
                this.setAttribute('aria-pressed', 'true');
                
                currentFilter = this.getAttribute('data-filter');
                currentPage = 1;
                applyFiltersAndSort();
            });
        });

        // Clear filters button
        document.getElementById('clear-filters').addEventListener('click', function() {
            document.querySelectorAll('.btn-toggle').forEach(b => b.setAttribute('aria-pressed', 'false'));
            document.querySelector('[data-filter="all"]').setAttribute('aria-pressed', 'true');
            currentFilter = 'all';
            currentPage = 1;
            applyFiltersAndSort();
        });

        // Tag filter buttons in cards
        document.querySelectorAll('.tag-filter-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation(); // Prevent card click
                
                const tagFilter = this.getAttribute('data-tag');
                
                // Reset all filter buttons
                document.querySelectorAll('.btn-toggle').forEach(b => b.setAttribute('aria-pressed', 'false'));
                
                // Find and activate the corresponding filter button
                const filterButton = document.querySelector(`[data-filter="${tagFilter}"]`);
                if (filterButton) {
                    filterButton.setAttribute('aria-pressed', 'true');
                    currentFilter = tagFilter;
                } else {
                    // If no matching filter button exists, show all
                    document.querySelector('[data-filter="all"]').setAttribute('aria-pressed', 'true');
                    currentFilter = 'all';
                }
                
                currentPage = 1;
                applyFiltersAndSort();
                
                // Scroll to top of results
                document.getElementById('main-content').scrollIntoView({ behavior: 'smooth' });
            });
        });

        // Search functionality
        const searchInput = document.querySelector('input[type="text"]');
        searchInput.addEventListener('input', function() {
            currentSearchTerm = this.value.toLowerCase();
            currentPage = 1;
            applyFiltersAndSort();
        });

        // Sort functionality
        const sortSelect = document.getElementById('sort-select');
        sortSelect.addEventListener('change', function() {
            currentSort = this.value;
            currentPage = 1;
            applyFiltersAndSort();
        });

        // Main function to apply filters, search, and sorting
        function applyFiltersAndSort() {
            // Start with all cards
            filteredCards = [...allCards];

            // Apply category filter
            if (currentFilter !== 'all') {
                filteredCards = filteredCards.filter(card => {
                    const tags = card.getAttribute('data-tags');
                    return tags && tags.includes(currentFilter.toLowerCase());
                });
            }

            // Apply search filter
            if (currentSearchTerm !== '') {
                filteredCards = filteredCards.filter(card => {
                    const title = card.querySelector('.card-title').textContent.toLowerCase();
                    const description = card.querySelector('.card-text').textContent.toLowerCase();
                    return title.includes(currentSearchTerm) || description.includes(currentSearchTerm);
                });
            }

            // Apply sorting
            filteredCards.sort((a, b) => {
                if (currentSort === 'newest') {
                    const dateA = parseInt(a.getAttribute('data-date'));
                    const dateB = parseInt(b.getAttribute('data-date'));
                    return dateB - dateA; // Newest first
                } else if (currentSort === 'highest') {
                    const likesA = parseInt(a.getAttribute('data-likes') || '0');
                    const likesB = parseInt(b.getAttribute('data-likes') || '0');
                    return likesB - likesA; // Highest likes first
                } else if (currentSort === 'alphabetical') {
                    const titleA = a.querySelector('.card-title').textContent;
                    const titleB = b.querySelector('.card-title').textContent;
                    return titleA.localeCompare(titleB);
                }
                return 0;
            });

            // Hide all cards first
            allCards.forEach(card => {
                card.style.display = 'none';
            });

            // Show/hide no results message
            const noResultsMessage = document.getElementById('no-results-message');
            if (filteredCards.length === 0) {
                noResultsMessage.style.display = 'block';
            } else {
                noResultsMessage.style.display = 'none';
            }

            // Update pagination and show current page
            updatePagination();
            showPage(currentPage);
        }

        // Pagination functions
        function updatePagination() {
            const totalPages = Math.ceil(filteredCards.length / itemsPerPage);
            const paginationContainer = document.querySelector('.pagination');
            
            // Clear existing pagination
            paginationContainer.innerHTML = '';

            // Previous button
            const prevLi = document.createElement('li');
            prevLi.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
            prevLi.innerHTML = `<a class="page-link" href="#" ${currentPage === 1 ? 'tabindex="-1" aria-disabled="true"' : ''}>Previous</a>`;
            if (currentPage > 1) {
                prevLi.addEventListener('click', (e) => {
                    e.preventDefault();
                    changePage(currentPage - 1);
                });
            }
            paginationContainer.appendChild(prevLi);

            // Page numbers
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, startPage + 4);

            for (let i = startPage; i <= endPage; i++) {
                const pageLi = document.createElement('li');
                pageLi.className = `page-item ${i === currentPage ? 'active' : ''}`;
                pageLi.innerHTML = `<a class="page-link" href="#" ${i === currentPage ? 'aria-current="page"' : ''}>${i}</a>`;
                
                if (i !== currentPage) {
                    pageLi.addEventListener('click', (e) => {
                        e.preventDefault();
                        changePage(i);
                    });
                }
                paginationContainer.appendChild(pageLi);
            }

            // Next button
            const nextLi = document.createElement('li');
            nextLi.className = `page-item ${currentPage === totalPages || totalPages === 0 ? 'disabled' : ''}`;
            nextLi.innerHTML = `<a class="page-link" href="#">Next</a>`;
            if (currentPage < totalPages && totalPages > 0) {
                nextLi.addEventListener('click', (e) => {
                    e.preventDefault();
                    changePage(currentPage + 1);
                });
            }
            paginationContainer.appendChild(nextLi);

            // Hide pagination if only one page or no results
            const paginationNav = document.querySelector('nav[aria-label="Prompt pagination"]');
            if (totalPages <= 1) {
                paginationNav.style.display = 'none';
            } else {
                paginationNav.style.display = 'block';
            }
        }

        function changePage(page) {
            currentPage = page;
            showPage(page);
            updatePagination();
            
            // Scroll to top of results
            document.getElementById('main-content').scrollIntoView({ behavior: 'smooth' });
        }

        function showPage(page) {
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;

            // Hide all cards first
            allCards.forEach(card => {
                card.style.display = 'none';
            });

            // Show cards for current page
            filteredCards.slice(startIndex, endIndex).forEach(card => {
                card.style.display = '';
            });
        }

        // Copy prompt to clipboard - enhanced
        document.querySelectorAll('.btn-copy-prompt').forEach(btn => {
            btn.addEventListener('click', function() {
                const promptUrl = this.getAttribute('data-prompt-url');
                const promptTitle = this.getAttribute('data-prompt-title');
                const promptDescription = this.closest('.card-body').querySelector('.card-text').innerText;
                
                const textToCopy = `${promptTitle}\n\n${promptDescription}\n\nView full prompt: ${window.location.origin}${promptUrl}`;
                
                navigator.clipboard.writeText(textToCopy).then(() => {
                    this.innerHTML = '<i class="fas fa-check"></i> Copied!';
                    this.classList.remove('animate__pulse');
                    void this.offsetWidth;
                    this.classList.add('animate__pulse');
                    setTimeout(() => {
                        this.innerHTML = '<i class="fas fa-copy"></i> Copy Prompt';
                        this.classList.remove('animate__pulse');
                    }, 1500);
                }).catch(err => {
                    console.error('Failed to copy text: ', err);
                    this.innerHTML = '<i class="fas fa-link"></i> Visit Page';
                    setTimeout(() => {
                        this.innerHTML = '<i class="fas fa-copy"></i> Copy Prompt';
                    }, 1500);
                });
            });
        });

        // Like button functionality with persistence
        document.querySelectorAll('.btn-like').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                const countSpan = this.querySelector('.like-count');
                const cardCol = this.closest('.col[data-tags]');
                let count = parseInt(countSpan.textContent, 10);
                
                if (!this.classList.contains('liked')) {
                    count++;
                    this.classList.add('liked');
                    this.querySelector('i').classList.add('text-danger');
                } else {
                    count--;
                    this.classList.remove('liked');
                    this.querySelector('i').classList.remove('text-danger');
                }
                
                countSpan.textContent = count;
                cardCol.setAttribute('data-likes', count);
                
                // Save to localStorage
                const promptTitle = this.closest('.card').querySelector('.card-title').textContent;
                localStorage.setItem(`prompt-like-${promptTitle}`, count);
                
                // If currently sorting by highest, re-sort
                if (currentSort === 'highest') {
                    applyFiltersAndSort();
                }
            });
        });

        // Load saved likes from localStorage
        window.addEventListener('load', function() {
            document.querySelectorAll('.btn-like').forEach(btn => {
                const promptTitle = btn.closest('.card').querySelector('.card-title').textContent;
                const savedCount = localStorage.getItem(`prompt-like-${promptTitle}`);
                if (savedCount) {
                    const countSpan = btn.querySelector('.like-count');
                    const cardCol = btn.closest('.col[data-tags]');
                    countSpan.textContent = savedCount;
                    cardCol.setAttribute('data-likes', savedCount);
                    
                    if (parseInt(savedCount) > 0) {
                        btn.classList.add('liked');
                        btn.querySelector('i').classList.add('text-danger');
                    }
                }
            });
            
            // Refresh the display after loading likes
            applyFiltersAndSort();
        });
    </script>
</body>
</html>