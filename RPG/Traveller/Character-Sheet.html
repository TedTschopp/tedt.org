<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traveller 2nd Edition Character Sheet</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Add Google Fonts for Traveller-like typography -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Arsenal:wght@400;700&family=Marcellus&family=Roboto:wght@400;500;700&family=Arimo:wght@400;500;700&family=Work+Sans:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Light Mode (only mode now) */
            --traveller-primary: #111111;    /* Deep Black for backgrounds, headers, footers */
            --traveller-secondary: #F0F0F0;  /* Light Grey for text and content background */
            --traveller-tertiary: #BB0000;   /* Traveller Red for highlights, call to actions */
            --traveller-supporting: #888888; /* Neutral Grey for supporting elements */
            --traveller-text-on-dark: #FFFFFF; /* White text for dark backgrounds */
            --traveller-text-on-light: #333333; /* Dark text for light backgrounds */
            --traveller-border: #DDDDDD;
            --traveller-content-bg: #FFFFFF;
            --traveller-input-bg: #FFFFFF;
            --traveller-input-border: #CED4DA;
            --traveller-characteristic-box-bg: #F0F0F0;
            --traveller-table-bg: #FFFFFF;
            --traveller-table-border: #DEE2E6;
            --traveller-table-header-bg: rgba(17, 17, 17, 0.1);
            
            /* Font families */
            --font-headlines: 'Arsenal', sans-serif;
            --font-titles: 'Marcellus', serif;
            --font-ui: 'Roboto', sans-serif;
            --font-standard: 'Arimo', sans-serif;
            --font-secondary: 'Work Sans', sans-serif;
        }
        
        body {
            background-color: var(--traveller-secondary);
            font-family: var(--font-standard);
            color: var(--traveller-text-on-light);
            transition: background-color 0.3s ease;
        }
        
        .character-sheet {
            max-width: 1200px;
            margin: 20px auto;
            background-color: var(--traveller-content-bg);
            padding: 20px;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.15);
            border-radius: 3px;
            position: relative;
            border: 1px solid var(--traveller-border);
            transition: all 0.3s ease;
        }
        
        .characteristic-box {
            border: 2px solid var(--traveller-primary);
            border-radius: 3px;
            padding: 15px;
            text-align: center;
            margin-bottom: 15px;
            background-color: var(--traveller-characteristic-box-bg);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        /* Rest of your existing CSS remains the same, the theme variables will apply automatically */
        
        .sheet-header {
            background-color: var(--traveller-primary);
            color: var(--traveller-text-on-dark);
            padding: 20px 15px;
            margin-bottom: 25px;
            border-radius: 3px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .sheet-header h1 {
            margin: 0;
            font-family: var(--font-titles);
            font-weight: 400;
            font-size: 2.2rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            text-shadow: 0px 2px 2px rgba(0, 0, 0, 0.3);
        }
        
        .sheet-header::after {
            content: "";
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 100%;
            height: 6px;
            background-color: var(--traveller-tertiary);
        }
        
        /* Optional starburst/logo effect */
        .sheet-header::before {
            content: "";
            position: absolute;
            top: -25px;
            right: -25px;
            width: 150px;
            height: 150px;
            background: radial-gradient(var(--traveller-tertiary) 10%, transparent 65%);
            opacity: 0.5;
            border-radius: 50%;
        }
        
        .section-header {
            background-color: var(--traveller-primary);
            color: var(--traveller-text-on-dark);
            padding: 8px 15px;
            margin-top: 20px;
            margin-bottom: 15px;
            border-radius: 3px;
            font-weight: 700;
            font-family: var(--font-headlines);
            letter-spacing: 0.5px;
            border-left: 4px solid var(--traveller-tertiary);
        }
        
        .skill-item, .equipment-item, .weapon-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
            border-bottom: 1px solid var(--traveller-border);
        }
        
        .characteristic-box {
            border: 2px solid var(--traveller-primary);
            border-radius: 3px;
            padding: 15px;
            text-align: center;
            margin-bottom: 15px;
            background-color: var(--traveller-secondary);
            position: relative;
            overflow: hidden;
        }
        
        .characteristic-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background-color: var(--traveller-tertiary);
        }
        
        .characteristic-box h4 {
            margin: 0;
            color: var(--traveller-primary);
            font-family: var(--font-headlines);
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        .characteristic-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--traveller-primary);
            font-family: var(--font-standard);
        }
        
        .characteristic-dm {
            font-size: 1.2rem;
            color: var(--traveller-tertiary);
            font-weight: bold;
            font-family: var(--font-standard);
        }
        
        .important-stat {
            font-weight: bold;
            color: var (--traveller-tertiary);
            font-family: var(--font-headlines);
        }
        
        label.form-label {
            font-weight: 500;
            color: var(--traveller-primary);
            font-family: var(--font-headlines);
        }
        
        /* Button styling */
        .dice-btn {
            background-color: var(--traveller-primary);
            color: var(--traveller-text-on-dark);
            border: none;
            padding: 5px 15px;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: var(--font-ui);
            font-weight: 500;
            letter-spacing: 0.25px;
        }
        
        .dice-btn:hover {
            background-color: var(--traveller-tertiary);
        
        .dice-btn:hover {
            background-color: var(--traveller-tertiary);
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .btn-secondary {
            background-color: var(--traveller-supporting);
            border-color: var(--traveller-supporting);
            color: var (--traveller-text-on-dark);
            font-family: var (--font-ui);
            font-weight: 500;
        .btn-secondary:hover {
            background-color: var(--traveller-tertiary);
            border-color: var(--traveller-tertiary);
        }
        
        .btn-info {
            background-color: var(--traveller-supporting);
            border-color: var(--traveller-supporting);
            color: var (--traveller-text-on-dark);
            font-family: var (--font-ui);
            font-weight: 500;
            letter-spacing: 0.25px;
        }
        
        .btn-info:hover {
            background-color: var (--traveller-tertiary);
            border-color: var(--traveller-tertiary);
        }
        
        .btn-danger {
            background-color: var(--traveller-tertiary);
            border-color: var(--traveller-tertiary);
            font-family: var(--font-ui);
            font-weight: 500;
            letter-spacing: 0.25px;
        }
        
        .btn-add {
            background-color: var(--traveller-tertiary);  /* Changed to red */
            color: var(--traveller-text-on-dark);
            border: none;
            font-family: var(--font-ui);
            font-weight: 500;
            letter-spacing: 0.25px;
        }
        
        .btn-add:hover {
            background-color: #000000;  /* Changed to black */
            color: var(--traveller-text-on-dark);
        }
        
        .btn-remove {
            background-color: var(--traveller-tertiary);
            color: var (--traveller-text-on-dark);
            border: none;
            padding: 2px 8px;
            font-size: 0.8rem;
            border-radius: 3px;
            font-family: var (--font-ui);
            font-weight: 500;
            letter-spacing: 0.25px;
        }
        
        .btn-remove:hover {
            background-color: #700000;
        }
        
        table thead th {
            background-color: rgba(17, 17, 17, 0.1); /* Semitransparent primary */
            color: var(--traveller-primary);
            font-family: var(--font-headlines);
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        .skill-name {
            font-weight: 600;
            color: var(--traveller-primary);
            font-family: var(--font-standard);
        }
        
        .skill-specialization {
            font-style: italic;
            color: var(--traveller-supporting);
            margin-left: 3px;
            font-family: var(--font-secondary);
            font-weight: 400;
        }
        
        #specializationField {
            max-width: 150px;
        }
        
        @media print {
            .no-print {
                display: none;
            }
            
            body {
                background-color: white;
            }
            
            .character-sheet {
                box-shadow: none;
                margin: 0;
                padding: 10px;
            }
        }

        .credits {
            margin-top: 20px;
            text-align: center;
            font-size: 0.8rem;
            color: var(--traveller-supporting);
            font-family: var(--font-secondary);
        }
        
        #roll-result {
            font-weight: bold;
            font-size: 1.2rem;
            min-height: 30px;
            margin-top: 10px;
            text-align: center;
            font-family: var (--font-ui);
            color: var(--traveller-tertiary);
        }

        /* Improved focus styles for accessibility */
        input:focus, select:focus, textarea:focus, button:focus {
            outline: 2px solid var(--traveller-tertiary);
            box-shadow: 0 0 0 2px rgba(187, 0, 0, 0.25);
        }
        
        /* Custom scrollbar to match theme */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--traveller-secondary);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--traveller-supporting);
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--traveller-tertiary);
        }

        /* Styles for dual characteristic values */
        .characteristic-box {
            /* Adjust padding to fit more content */
            padding: 12px 10px;
        }
        
        .char-values {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .char-value {
            flex: 1;
            padding: 0 2px;
        }
        
        .char-value label {
            font-size: 0.7rem;
            display: block;
            text-align: center;
            margin: 0;
            color: var(--traveller-supporting);
        }
        
        .char-value input {
            padding: 2px;
            text-align: center;
            height: auto;
            font-size: 1.2rem;
        }
        
        .characteristic-dm-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 5px;
        }
        
        .characteristic-dm-current {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--traveller-tertiary);
        }
        
        .characteristic-dm-baseline {
            font-size: 0.9rem;
            color: var(--traveller-supporting);
        }
        
        .characteristic-dm-separator {
            margin: 0 3px;
            color: var(--traveller-supporting);
        }

        /* Add these styles to your existing CSS */
        .wealth-dm {
            background-color: var(--traveller-tertiary);
            color: var(--traveller-text-on-dark);
            font-weight: bold;
        }

        small.text-muted {
            display: block;
            margin-top: 4px;
            font-family: var(--font-secondary);
        }

        .wealth-info {
            font-size: 0.7rem;
            color: var(--traveller-supporting);
            font-style: italic;
        }
        
        .wealth-reference {
            display: block;
            margin-top: 2px;
            font-size: 0.75rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container character-sheet">
        <div class="sheet-header">
            <h1>TRAVELLER 2ND EDITION</h1>
        </div>
        
        <!-- Character Information -->
        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="charName" class="form-label">Character Name</label>
                <input type="text" class="form-control" id="charName">
            </div>
            <div class="col-md-4 mb-3">
                <label for="species" class="form-label">Species</label>
                <input type="text" class="form-control" id="species" value="Human">
            </div>
            <div class="col-md-4 mb-3">
                <label for="age" class="form-label">Age</label>
                <input type="number" class="form-control" id="age" value="18">
            </div>
        </div>
        
        <!-- Pre-Career Options Section (renamed from Pre-Career Education) -->
        <div class="row">
            <div class="col-md-12 mb-3">
                <div class="section-header">
                    PRE-CAREER OPTIONS
                </div>
                
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Years</th>
                                <th>Outcome</th>
                                <th>Benefits</th>
                                <th class="no-print">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="education-container">
                            <!-- Pre-career options will be added here by JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div class="row mb-3 no-print">
                    <div class="col-md-12">
                        <div class="input-group">
                            <select class="form-control" id="educationType">
                                <option value="">Select Pre-Career Option...</option>
                                <option value="University">University</option>
                                <option value="Military Academy">Military Academy</option>
                                <option value="Colonial Upbringing">Colonial Upbringing</option>
                                <option value="Merchant Academy">Merchant Academy</option>
                                <option value="Psionic Community">Psionic Community</option>
                                <option value="School of Hard Knocks">School of Hard Knocks</option>
                                <option value="Spacer Community">Spacer Community</option>
                            </select>
                            <input type="number" class="form-control" id="educationYears" placeholder="Years" min="1" value="4" style="max-width: 80px;">
                            <select class="form-control" id="educationOutcome">
                                <option value="Graduate">Graduate</option>
                                <option value="Graduate with Honors">Graduate with Honors</option>
                            </select>
                            <input type="text" class="form-control" id="educationBenefits" placeholder="Benefits">
                            <button class="btn btn-add" id="addEducationBtn" onclick="addEducation()">Add Option</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-12 mb-3">
                <div class="section-header">
                    CAREER HISTORY
                </div>
                
                <div class="table-responsive">
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>Career</th>
                                <th>Assignment</th>
                                <th>Terms</th>
                                <th>Rank & Title</th>
                                <th>Benefits</th>
                                <th class="no-print">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="careers-container">
                            <!-- Careers will be added here by JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div class="row mb-3 no-print">
                    <div class="col-md-12">
                        <div class="input-group">
                            <select class="form-control" id="careerName" onchange="updateAssignments()">
                                <option value="">Select Career...</option>
                                <!-- Career options will be populated by JavaScript -->
                            </select>
                            <select class="form-control" id="careerAssignment">
                                <option value="">Select Assignment...</option>
                                <!-- Assignments will be populated based on career -->
                            </select>
                            <input type="number" class="form-control" id="careerTerms" placeholder="Terms" min="1" value="1" style="max-width: 100px;" onchange="suggestRank()">
                            <input type="text" class="form-control" id="careerRank" placeholder="Rank & Title">
                            <button class="btn btn-info" type="button" onclick="suggestRank()" style="max-width: 40px;">
                                <i class="fa fa-sync">↻</i>
                            </button>
                            <input type="text" class="form-control" id="careerBenefits" placeholder="Benefits">
                            <button class="btn btn-add" onclick="addCareer()">Add Career</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Characteristics Section -->
        <div class="section-header">
            CHARACTERISTICS
        </div>

        <div class="row">
            <div class="col-md-2">
                <div class="characteristic-box">
                    <h4>STR</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="str-current" value="7" min="0" max="15" oninput="updateDM('str')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="str-baseline" value="7" min="0" max="15" oninput="updateDM('str')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="str-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="str-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="characteristic-box">
                    <h4>DEX</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="dex-current" value="7" min="0" max="15" oninput="updateDM('dex')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="dex-baseline" value="7" min="0" max="15" oninput="updateDM('dex')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="dex-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="dex-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="characteristic-box">
                    <h4>END</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="end-current" value="7" min="0" max="15" oninput="updateDM('end')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="end-baseline" value="7" min="0" max="15" oninput="updateDM('end')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="end-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="end-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="characteristic-box">
                    <h4>INT</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="int-current" value="7" min="0" max="15" oninput="updateDM('int')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="int-baseline" value="7" min="0" max="15" oninput="updateDM('int')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="int-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="int-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="characteristic-box">
                    <h4>EDU</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="edu-current" value="7" min="0" max="15" oninput="updateDM('edu')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="edu-baseline" value="7" min="0" max="15" oninput="updateDM('edu')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="edu-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="edu-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
            <div class="col-md-2">
                <div class="characteristic-box">
                    <h4>SOC</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="soc-current" value="7" min="0" max="15" oninput="updateDM('soc')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="soc-baseline" value="7" min="0" max="15" oninput="updateDM('soc')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="soc-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="soc-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Additional Characteristics Section (replacing Secondary Characteristics) -->
        <div class="section-header mt-4">
            ADDITIONAL CHARACTERISTICS
        </div>
        
        <div class="row">
            <div class="col-md-2 mb-3">
                <div class="characteristic-box">
                    <h4>Morale</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="mrl-current" value="7" min="0"
                                max="15" oninput="updateDM('mrl')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="mrl-baseline" value="7" min="0"
                                max="15" oninput="updateDM('mrl')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="mrl-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="mrl-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
            <div class="col-md-2 mb-3">
                <div class="characteristic-box">
                    <h4>Luck</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="lck-current" value="7" min="0" max="15" oninput="updateDM('lck')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="lck-baseline" value="7" min="0" max="15" oninput="updateDM('lck')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="lck-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="lck-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
            <div class="col-md-2 mb-3">
                <div class="characteristic-box">
                    <h4>Sanity</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="sty-current" value="7" min="0" max="15" oninput="updateDM('sty')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="sty-baseline" value="7" min="0" max="15" oninput="updateDM('sty')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="sty-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="sty-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
            <div class="col-md-2 mb-3">
                <div class="characteristic-box">
                    <h4>Charm</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="chr-current" value="7" min="0"
                                max="15" oninput="updateDM('chr')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="chr-baseline" value="7" min="0"
                                max="15" oninput="updateDM('chr')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="chr-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="chr-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
            <div class="col-md-2 mb-3">
                <div class="characteristic-box">
                    <h4>Psionics</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="psi-current" value="7" min="0"
                                max="15" oninput="updateDM('psi')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="psi-baseline" value="7" min="0"
                                max="15" oninput="updateDM('psi')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="psi-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="psi-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
            <div class="col-md-2 mb-3">
                <div class="characteristic-box">
                    <h4>Standing</h4>
                    <div class="char-values">
                        <div class="char-value">
                            <label>Current</label>
                            <input type="number" class="form-control characteristic-value" id="std-current" value="7" min="0" max="15" oninput="updateDM('std')">
                        </div>
                        <div class="char-value">
                            <label>Baseline</label>
                            <input type="number" class="form-control characteristic-value" id="std-baseline" value="7" min="0" max="15" oninput="updateDM('std')">
                        </div>
                    </div>
                    <div class="characteristic-dm-container">
                        <span class="characteristic-dm-current" id="std-dm-current">+0</span>
                        <span class="characteristic-dm-separator">/</span>
                        <span class="characteristic-dm-baseline" id="std-dm-baseline">+0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Skills Section -->
        <div class="section-header">
            SKILLS
        </div>
        
        <div class="row skill-search no-print">
            <div class="col-md-10 mb-2">
                <div class="input-group">
                    <input type="text" class="form-control" id="skillSearch" placeholder="Skill name...">
                    <input type="text" class="form-control" id="specializationField" placeholder="Specialization (optional)">
                    <input type="number" class="form-control" id="skillLevel" placeholder="Level" min="0" value="0" style="max-width: 80px;">
                    <button class="btn btn-add" onclick="addSkill()">Add</button>
                </div>
            </div>
        </div>
        
        <div id="skills-container">
            <!-- Skills will be added here by JavaScript -->
        </div>

        <!-- Weapons Section -->
        <div class="section-header">
            WEAPONS & ATTACKS
        </div>
        
        <div class="row mb-3 no-print">
            <div class="col-md-12">
                <div class="input-group">
                    <input type="text" class="form-control" id="weaponName" placeholder="Weapon Name">
                    <input type="text" class="form-control" id="weaponDamage" placeholder="Damage" style="max-width: 120px;">
                    <input type="number" class="form-control" id="weaponRange" placeholder="Range" style="max-width: 80px;">
                    <button class="btn btn-add" onclick="addWeapon()">Add</button>
                </div>
            </div>
        </div>
        
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Weapon</th>
                        <th>Skill</th>
                        <th>Damage</th>
                        <th>Range</th>
                        <th class="no-print">Actions</th>
                    </tr>
                </thead>
                <tbody id="weapons-container">
                    <!-- Weapons will be added here by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Armor Section -->
        <div class="section-header">
            ARMOR
        </div>
        
        <div class="row mb-3 no-print">
            <div class="col-md-12">
                <div class="input-group">
                    <input type="text" class="form-control" id="armorName" placeholder="Armor Name">
                    <input type="number" class="form-control" id="armorRating" placeholder="Rating" style="max-width: 100px;" min="0">
                    <input type="text" class="form-control" id="armorTL" placeholder="TL" style="max-width: 60px;">
                    <input type="text" class="form-control" id="armorRadiation" placeholder="Rad" style="max-width: 60px;">
                    <button class="btn btn-add" onclick="addArmor()">Add</button>
                </div>
            </div>
        </div>
        
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Armor</th>
                        <th>Rating</th>
                        <th>TL</th>
                        <th>Rad</th>
                        <th class="no-print">Actions</th>
                    </tr>
                </thead>
                <tbody id="armor-container">
                    <!-- Armor will be added here by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Equipment Section -->
        <div class="section-header">
            EQUIPMENT
        </div>
        
        <div class="row mb-3 no-print">
            <div class="col-md-12">
                <div class="input-group">
                    <input type="text" class="form-control" id="equipmentName" placeholder="Equipment Name">
                    <input type="text" class="form-control" id="equipmentTL" placeholder="TL" style="max-width: 60px;">
                    <input type="number" class="form-control" id="equipmentMass" placeholder="Mass" style="max-width: 80px;" step="0.1">
                    <input type="number" class="form-control" id="equipmentCost" placeholder="Cost" style="max-width: 100px;">
                    <button class="btn btn-add" onclick="addEquipment()">Add</button>
                </div>
            </div>
        </div>
        
        <div class="table-responsive">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Equipment</th>
                        <th>TL</th>
                        <th>Mass</th>
                        <th>Cost (Cr)</th>
                        <th class="no-print">Actions</th>
                    </tr>
                </thead>
                <tbody id="equipment-container">
                    <!-- Equipment will be added here by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Finances -->
        <div class="section-header">
            FINANCES
        </div>

        <!-- First row with wealth level only -->
        <div class="row">
            <div class="col-md-3 mb-3">
                <label for="wlt-current" class="form-label">Wealth Level - Cash Obtainable</label>
                <div class="char-values">
                    <div class="char-value">
                        <label>Current <span class="wealth-info">(7 = Cr 2,000)</span></label>
                        <input type="number" class="form-control characteristic-value" id="wlt-current" value="7" min="0" max="15" oninput="updateDM('wlt'); updateWealthInfoDisplay();">
                        <small class="text-muted wealth-reference" id="current-wealth-value">Cr 2,000 available</small>
                    </div>
                    <div class="char-value">
                        <label>Baseline <span class="wealth-info">(7 = Cr 2,000)</span></label>
                        <input type="number" class="form-control characteristic-value" id="wlt-baseline" value="7" min="0" max="15" oninput="updateDM('wlt'); updateWealthInfoDisplay();">
                        <small class="text-muted wealth-reference" id="baseline-wealth-value">Cr 2,000 baseline</small>
                    </div>
                </div>
                <div class="characteristic-dm-container">
                    <span class="characteristic-dm-current" id="wlt-dm-current">+0</span>
                    <span class="characteristic-dm-separator">/</span>
                    <span class="characteristic-dm-baseline" id="wlt-dm-baseline">+0</span>
                </div>
                <button class="btn btn-sm btn-secondary mt-1" type="button" 
                        data-bs-toggle="collapse" data-bs-target="#wealthReferenceTable" 
                        aria-expanded="false" aria-controls="wealthReferenceTable">
                    Show Wealth Reference
                </button>
                <div class="collapse mt-2" id="wealthReferenceTable">
                    <div class="card card-body p-2">
                        <small>
                            <strong>Wealth Reference:</strong><br>
                            1 = Cr 100 | 2 = Cr 200 | 3 = Cr 400<br>
                            4 = Cr 800 | 5 = Cr 1,200 | 6 = Cr 1,500<br>
                            7 = Cr 2,000 | 8 = Cr 3,000 | 9 = Cr 5,000<br>
                            10 = Cr 7,500 | 11 = Cr 10,000 | 12 = Cr 12,500<br>
                            13 = Cr 15,000 | 14 = Cr 17,500 | 15 = Cr 20,000
                        </small>
                    </div>
                </div>
            </div>
        
            <!-- Financial details in a single cell with 3 rows -->
            <div class="col-md-9 mb-3">
                <!-- Row 1 -->
                <div class="row mb-3">
                    <div class="col-md-4">
                        <label for="credits" class="form-label">Credits in the Bank</label>
                        <div class="input-group">
                            <span class="input-group-text">Cr</span>
                            <input type="number" class="form-control" id="credits" value="0">
                        </div>
                    </div>
                    
                    <div class="col-md-4">
                        <label for="cashOnHand" class="form-label">Cash on Hand</label>
                        <div class="input-group">
                            <span class="input-group-text">Cr</span>
                            <input type="number" class="form-control" id="cashOnHand" value="0">
                        </div>
                    </div>
        
                    <div class="col-md-4">
                        <label for="pension" class="form-label">Monthly Pension</label>
                        <div class="input-group">
                            <span class="input-group-text">Cr</span>
                            <input type="number" class="form-control" id="pension" value="0">
                        </div>
                    </div>
                </div>
                
                <!-- Row 2 -->
                <div class="row mb-3">
                    <div class="col-md-4">
                        <label for="livingCosts" class="form-label">Living Costs</label>
                        <div class="input-group">
                            <span class="input-group-text">Cr</span>
                            <input type="number" class="form-control" id="livingCosts" value="0">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label for="shipPayments" class="form-label">Monthly Ship Payments</label>
                        <div class="input-group">
                            <span class="input-group-text">Cr</span>
                            <input type="number" class="form-control" id="shipPayments" value="0">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label for="shipCosts" class="form-label">Monthly Ship Costs</label>
                        <div class="input-group">
                            <span class="input-group-text">Cr</span>
                            <input type="number" class="form-control" id="shipCosts" value="0">
                        </div>
                    </div>
                </div>
                
                <!-- Row 3 -->
                <div class="row">
                    <div class="col-md-8">
                        <label for="financialNotes" class="form-label">Financial Notes</label>
                        <input type="text" class="form-control" id="financialNotes" placeholder="Assets, investments, loans, etc.">
                    </div>
                    <div class="col-md-4">
                        <label for="debt" class="form-label">Total Personal Debt</label>
                        <div class="input-group">
                            <span class="input-group-text">Cr</span>
                            <input type="number" class="form-control" id="debt" value="0">
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <!-- Dice Roller -->
        <div class="section-header no-print">
            DICE ROLLER
        </div>
        
        <div class="row no-print">
            <div class="col-md-12 text-center mb-3">
                <button class="btn dice-btn" onclick="rollDice(2, 6)">Roll 2D</button>
                <button class="btn dice-btn" onclick="rollTask(8)">Task (8+)</button>
                <button class="btn dice-btn" onclick="rollTask(10)">Hard Task (10+)</button>
                <button class="btn dice-btn" onclick="rollTask(12)">Formidable (12+)</button>
                <button class="btn dice-btn" onclick="rollTask(14)">Impossible (14+)</button>
                <div id="roll-result"></div>
            </div>
        </div>

        <!-- Notes -->
        <div class="section-header">
            NOTES
        </div>
        
        <div class="row mb-4">
            <div class="col-md-12">
                <textarea class="form-control" id="notes" rows="5"></textarea>
            </div>
        </div>

        <!-- Print Button -->
        <div class="row no-print">
            <div class="col-md-12 text-center">
                <button class="btn dice-btn" onclick="window.print()">Print Character Sheet</button>
                <button class="btn btn-secondary" onclick="saveCharacter()">Save Character</button>
                <button class="btn btn-secondary" onclick="loadCharacter()">Load Character</button>
                <button class="btn btn-danger" onclick="resetCharacter()">Reset Sheet</button>
                <button class="btn btn-info" onclick="exportCharacter()">Export Character</button>
                <button class="btn btn-info" onclick="importCharacter()">Import Character</button>
                <button class="btn btn-danger" onclick="deleteCharacter()">Delete Saved Character</button>
            </div>
        </div>
        
        <div class="credits">
            Traveller is a registered trademark of Far Future Enterprises. This character sheet is unofficial and for personal use only.
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Common Traveller Skills and data definitions
        const commonSkills = [
            "Admin", "Advocate", "Animals", "Athletics", "Astrogation", "Battle Dress",
            "Broker", "Carouse", "Deception", "Diplomat", "Drive", "Electronics", "Engineer",
            "Explosives", "Flyer", "Gambler", "Gun Combat", "Gunner", "Heavy Weapons", "Investigate",
            "Jack of all Trades", "Language", "Leadership", "Mechanic", "Medic", "Melee", "Navigation",
            "Persuade", "Pilot",  "Recon",  "Seafarer", "Stealth", "Steward",
            "Streetwise", "Survival", "Tactics", "Vacc Suit",

            // "Art", 
            // "Science",
            // "Profession",

            "Science: Life", "Science: Physical", "Science: Robotic", "Science: Social", "Science: Space",

            "Art: Performing", "Art: Creative", "Art: Presentation",
            
            "Profession: Colonist", "Profession: Freeloader", "Profession: Hostile Environment", "Profession: Spacer", "Profession: Sport", "Profession: Worker"
        ];

        // Skills that require adding all specializations when one is learned
        const skillsWithMandatorySpecializations = [
            "Athletics", "Drive", "Flyer", "Gunner", "Heavy Weapons", 
            "Melee", "Pilot", "Seafarer",

            "Art: Performing", "Art: Creative", "Art: Presentation",

            "Science: Life", "Science: Physical", "Science: Robotic", "Science: Social", "Science: Space",

            "Profession: Colonist", "Profession: Freeloader", "Profession: Hostile Environment", "Profession: Spacer", "Profession: Sport", "Profession: Worker"

        ];

        // Common specializations for skills
        const skillSpecializations = {
            "Animals": ["Handling", "Training", "Veterinary"],
            "Art: Performing": ["Performer", "Instrument"],
            "Art: Creative": ["Visual Media", "Exotic Media"],
            "Art: Presentation": ["Holography", "Write"],
            "Athletics": ["Dexterity", "Endurance", "Strength"],
            "Drive": ["Hovercraft", "Mole", "Tracked", "Walker", "Wheeled"],
            "Electronics": ["Comms", "Computers", "Remote Ops", "Sensors"],
            "Engineer": ["J-Drive", "Life Support", "M-Drive", "Power"],
            "Flyer": ["Airship", "Grav", "Ornithopter", "Rotor", "Wing"],
            "Gun Combat": ["Archaic", "Energy", "Slug"],
            "Gunner": ["Capital", "Ortillery", "Screen", "Turret"],
            "Heavy Weapons": ["Artillery", "Man Portable", "Vehicle"],
            "Language": ["Anglic", "Aslan", "Vargr", "Vilani", "Zdetl", "Oynprith", "Other"],
            "Mechanic": ["Aircraft", "Gravitics", "Mole", "Walker", "Wheeled"],
            "Melee": ["Blade", "Bludgeon", "Natural", "Unarmed", "Grapple", "Striking", "Fencing"],
            "Pilot": ["Capital Ships", "Small Craft", "Spacecraft"],
            "Profession: Colonist": ["Farming", "Ranching"],
            "Profession: Freeloader": ["Scrounging", "Security"],
            "Profession: Hostile Environment": ["Contaminant", "High-G", "Low-G", "Underwater"],
            "Profession: Spacer": ["Belter", "Crewmember"],
            "Profession: Sport": ["Atmosphere Surfing", "Golf", "Motorsport", "Racquet Sports", "Team Ball Sports", "Track & Field"],
            "Profession: Worker": ["Armourer", "Biologicals", "Civil Engineering", "Construction", "Hydroponics", "Metalworking", "Polymers"],
            "Science: Life": ["Biology", "Genetics", "Psionicology", "Xenology"],
            "Science: Physical": ["Chemistry", "Physics", "Jumpspace Physics"], 
            "Science: Robotic": ["Cybernetics", "Robotics"],
            "Science: Social": ["Archaeology", "Economics", "History", "Linguistics", "Philosophy", "Psychology", "Sophontology"],
            "Science: Space": ["Astronomy", "Cosmology", "Planetology"],

            "Seafarer": ["Ocean Ships", "Personal", "Sail", "Submarine"],
            "Tactics": ["Military", "Naval"]
        };

        // Career data structure with assignment-specific rank structures and discipline level
        const careerData = {
            "Agent (1)": {
                discipline: 0.5,  // Disciplined non-military
                assignments: {
                    "Law Enforcement": {
                        ranks: [
                            { title: "Rookie", level: 0 },
                            { title: "Corporal", level: 1 },
                            { title: "Sergeant", level: 2 },
                            { title: "Detective", level: 3 },
                            { title: "Lieutenant", level: 4 },
                            { title: "Chief", level: 5 },
                            { title: "Commissioner", level: 6 }
                        ]
                    },
                    "Intelligence": {
                        ranks: [
                            { title: " - ", level: 0 },
                            { title: "Agent", level: 1 },
                            { title: "Field Agent", level: 2 },
                            { title: "Field Agent", level: 3 },
                            { title: "Special Agent Director", level: 4 },
                            { title: "Assistant Director", level: 5 },
                            { title: "Director", level: 6 }
                        ]
                    },
                    "Corporate": {
                        ranks: [
                            { title: " - ", level: 0 },
                            { title: "Agent", level: 1 },
                            { title: "Field Agent", level: 2 },
                            { title: "Field Agent", level: 3 },
                            { title: "Special Agent Director", level: 4 },
                            { title: "Assistant Director", level: 5 },
                            { title: "Director", level: 6 }
                        ]
                    }
                }
            },
            "Army (2)": {
                discipline: 1.0,  // Military
                assignments: {
                    "Support": {
                        ranks: [
                            { title: "Private", level: 0 },
                            { title: "Lance Corporal", level: 1 },
                            { title: "Corporal", level: 2 },
                            { title: "Lance Sergeant", level: 3 },
                            { title: "Sergeant", level: 4 },
                            { title: "Gunnery Sergeant", level: 5 },
                            { title: "Sergeant Major", level: 6 }
                        ]
                    },
                    "Infantry": {
                        ranks: [
                            { title: "Private", level: 0 },
                            { title: "Lance Corporal", level: 1 },
                            { title: "Corporal", level: 2 },
                            { title: "Lance Sergeant", level: 3 },
                            { title: "Sergeant", level: 4 },
                            {
